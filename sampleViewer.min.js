(function(b){var c,a,e,h=b.tmpl,g=b.template,i=jQuery.fn.domManip,d,f='<table class="plusViewer"><tbody><tr><th class="header_${activeIndex === 0}">Result</th><th class="header_${activeIndex === 1}">Data</th>{{each tmpls}}<th class="header_${activeIndex === 2 + $index}">${$value.name}</th>{{/each}}</tr><tr><td colspan="${tmpls.length + 2}">{{if activeIndex === 0}}{{wrap wrapper}}{{tmpl(data) tmpls[0].tmpl}}{{/wrap}}{{else activeIndex === 1}}<textarea{{if !editable}} readonly{{/if}}>${$item.getData()}</textarea>{{else}}<textarea{{if !editable}} readonly{{/if}}>${tmpls[activeIndex - 2].markup}</textarea>{{/if}}</td></tr></tbody></table>';f=b.template(null,f);b.tmpl=function(f,d,e,b){if(!c&&!b)a={tmpls:[],tmplNames:{},activeIndex:0,data:d};return h(f,d,e,b)};b.extend(b.tmpl,h);b.template=function(d,e){var f,h,b=e;if(a&&a.tmplNames[d])return a.tmpls[a.tmplNames[d]-1].tmpl;else if(b&&!c){if(b instanceof jQuery)b=e[0]||{};if(b.nodeType){f="#"+b.getAttribute("id");b=b.innerHTML}if(typeof b==="string"){h=f||b;if(!a.tmplNames[h]){a.tmpls.push({markup:b,tmpl:b=g(d,e),name:f||"Template"});a.tmplNames[h]=a.tmpls.length;return b}}}return g(d,e)};jQuery.fn.extend({domManip:function(){if(!c){var f=0,e=this[0],d=b(e);d.addClass("plusViewerTarget");while(e!==document.body){if(d.hasClass("viewer")){a.wrapper=e.innerHTML;a.depth=f;a.persist=d.hasClass("persist"),a.editable=a.persist||d.hasClass("edit");d.addClass("plusTargetContainer");d.data("plusViewerState",a);d.data("plusViewerInitialState",b.extend(true,{},a));a=null;break}d=b(e=e.parentNode);f++}}return i.apply(this,arguments)}});function j(){return JSON.stringify(this.data.data,null,"\t")}b(function(){d=document.createElement("div");d.innerHTML="+";d.className="plusButton";document.body.appendChild(d);b(".plusTargetContainer").delegate(".header_false","click",function(){var d,e=b.tmplItem(this),f=e.data.activeIndex=b(this).index();c=true;a=e.data;e.update();a=null;c=false;if(!f)return;d=b(e.nodes[0]).find("textarea")[0];d.style.overflow="hidden";d.scrollHeight;d.style.height=d.scrollHeight+"px";d.style.overflow="auto"}).delegate("textarea","change",function(){var a=b.tmplItem(this);if(a.data.activeIndex===1)a.data.data=b.parseJSON(this.value);else{var d=this.value,e=a.data.tmpls[a.data.activeIndex-2];a.data.targetMarkup=d;e.markup=d;c=true;e.tmpl=b.template(null,d);c=false}}).hover(function(c){if(c.relatedTarget.className==="plusButton")return;if(e)e.style.border="solid transparent 1px";e=this;d.innerHTML=b(this).hasClass("activeViewer")?"-":"+";var a=b(this).offset();this.style.border="solid green 1px";d.style.left=a.left+"px";d.style.top=a.top+"px";d.style.display="block"},function(a){if(a.relatedTarget.className==="plusButton")return;e=null;d.style.display="none";this.style.border="solid transparent 1px"});b(".plusButton").click(function(){c=true;var d=b(e);if(this.innerHTML==="+"){a=d.data("plusViewerState");if(a.wrapper){var h=a.wrapper.split("plusViewerTarget");h[1]=h[1].split("></",2).join(">{{html $item.html()}}</");a.wrapper=h.join("plusViewerTarget")}else a.wrapper="{{! }}{{html $item.html()}}";a.activeIndex=0;b.tmpl(f,a,{getData:j}).appendTo(d.empty());this.innerHTML="-";d.addClass("activeViewer")}else{var g=b(e).children().first().tmplItem(),l=g.nodes,i=document.createElement("div"),m=l[0].parentNode,n=g.data.depth,k=d.data("plusViewerInitialState");i.innerHTML=k.wrapper;if(g.data.persist){a=g.data;d.data("plusViewerState",a)}else{a=k;d.data("plusViewerState",b.extend(true,{},a))}b.tmpl(a.tmpls[0].tmpl,a.data).appendTo(b(i).find(".plusViewerTarget"));jQuery(l).remove();m.innerHTML=i.innerHTML;this.innerHTML="+";d.removeClass("activeViewer")}a=null;c=false})})})(jQuery);if(!this.JSON)this.JSON={};(function(){function c(a){return a<10?"0"+a:a}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,d,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b;function g(a){f.lastIndex=0;return f.test(a)?'"'+a.replace(f,function(a){var b=i[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(m,n){var i,j,h,k,l=a,f,c=n[m];if(c&&typeof c==="object"&&typeof c.toJSON==="function")c=c.toJSON(m);if(typeof b==="function")c=b.call(n,m,c);switch(typeof c){case"string":return g(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";a+=d;f=[];if(Object.prototype.toString.apply(c)==="[object Array]"){k=c.length;for(i=0;i<k;i+=1)f[i]=e(i,c)||"null";h=f.length===0?"[]":a?"[\n"+a+f.join(",\n"+a)+"\n"+l+"]":"["+f.join(",")+"]";a=l;return h}if(b&&typeof b==="object"){k=b.length;for(i=0;i<k;i+=1){j=b[i];if(typeof j==="string"){h=e(j,c);h&&f.push(g(j)+(a?": ":":")+h)}}}else for(j in c)if(Object.hasOwnProperty.call(c,j)){h=e(j,c);h&&f.push(g(j)+(a?": ":":")+h)}h=f.length===0?"{}":a?"{\n"+a+f.join(",\n"+a)+"\n"+l+"}":"{"+f.join(",")+"}";a=l;return h}}if(typeof JSON.stringify!=="function")JSON.stringify=function(h,c,f){var g;a="";d="";if(typeof f==="number")for(g=0;g<f;g+=1)d+=" ";else if(typeof f==="string")d=f;b=c;if(c&&typeof c!=="function"&&(typeof c!=="object"||typeof c.length!=="number"))throw new Error("JSON.stringify");return e("",{"":h})};if(typeof JSON.parse!=="function")JSON.parse=function(a,c){var b;function d(f,g){var b,e,a=f[g];if(a&&typeof a==="object")for(b in a)if(Object.hasOwnProperty.call(a,b)){e=d(a,b);if(e!==undefined)a[b]=e;else delete a[b]}return c.call(f,g,a)}a=String(a);h.lastIndex=0;if(h.test(a))a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){b=eval("("+a+")");return typeof c==="function"?d({"":b},""):b}throw new SyntaxError("JSON.parse");}})()